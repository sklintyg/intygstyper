<div class="field-fade" ng-hide="viewState.avstangningSmittskydd()">
    <div ng-form="form4b">
        <a id="anchor-intygbaseratpa" name="anchor.intygbaseratpa"></a>

        <div id="intygetbaseraspa" wc-field field-label="fk7263.label.intygbaseratpa" field-number="4b"
             field-help-text="fk7263.helptext.intyg-baserat-pa"
             field-has-errors="viewState.common.validation.messagesGrouped.intygbaseratpa"
             field-required="true">

            <wc-validation-group field-type="check-group" validations="viewState.getValidationErrors('intygbaseratpa')">

                <!-- Undersökning -->
                <div class="form-group form-inline">
                    <wc-validation-wrapper field-type="date" validations="viewState.getValidationErrors('undersokning')">
                        <label class="checkbox inline-block" style="min-width: 250px"><input type="checkbox"
                                                                                             id="basedOnExamination"
                                                                                             name="informationBasedOn.examination"
                                                                                             class="checkbox-inline"
                                                                                             ng-model="basedOnState.check.undersokningAvPatienten"
                                                                                             ng-change="toggleBaseradPaDate('undersokningAvPatienten'); validate()"
                                                                                             value="true">
                            Min undersökning av patienten</label>
                        <span wc-date-picker-field target-model="dates.undersokningAvPatienten"
                              dom-id="undersokningAvPatientenDate" add-date-parser="loose"
                              on-blur="validate()"></span>
                    </wc-validation-wrapper>
                </div>

                <!-- Telefonkontakt -->
                <div class="form-group form-inline">
                    <wc-validation-wrapper field-type="date" validations="viewState.getValidationErrors('telefonkontakt')">
                        <label class="checkbox inline-block" style="min-width: 250px"><input type="checkbox"
                                                                                             id="basedOnPhoneContact"
                                                                                         name="informationBasedOn.phoneContact"
                                                                                         ng-model="basedOnState.check.telefonkontaktMedPatienten"
                                                                                         ng-change="toggleBaseradPaDate('telefonkontaktMedPatienten'); validate()">
                        Min telefonkontakt med patienten</label>
                        <span wc-date-picker-field target-model="dates.telefonkontaktMedPatienten"
                              dom-id="telefonkontaktMedPatientenDate" add-date-parser="loose"
                              on-blur="validate()"></span>
                    </wc-validation-wrapper>
                </div>

                <!-- Journaluppgifter -->
                <div class="form-group form-inline">
                    <wc-validation-wrapper field-type="date" validations="viewState.getValidationErrors('journaluppgifter')">
                        <label class="checkbox inline-block" style="min-width: 250px"><input type="checkbox"
                                                                                             id="basedOnJournal"
                                                                                             name="informationBasedOn.journal"
                                                                                             ng-model="basedOnState.check.journaluppgifter"
                                                                                             ng-change="toggleBaseradPaDate('journaluppgifter'); validate()">
                            Journaluppgifter</label>
                        <span wc-date-picker-field target-model="dates.journaluppgifter"
                              dom-id="journaluppgifterDate" add-date-parser="loose"
                              on-blur="validate()"></span>
                    </wc-validation-wrapper>
                </div>

                <!-- Annat -->
                <div class="form-group form-inline">
                    <wc-validation-wrapper field-type="date" validations="viewState.getValidationErrors('referenser')">
                        <label class="checkbox inline-block" style="min-width: 250px"><input type="checkbox"
                                                                                             id="basedOnOther"
                                                                                             name="informationBasedOn.other"
                                                                                             ng-model="basedOnState.check.annanReferens"
                                                                                             ng-change="toggleBaseradPaDate('annanReferens'); validate()">
                            Annat<span wc-help-mark field-help-text="fk7263.helptext.intyg-baserat-pa.annat"></span>
                        </label>
                        <span wc-date-picker-field target-model="dates.annanReferens" dom-id="annanReferensDate" add-date-parser="loose" on-blur="validate()"></span>
                    </wc-validation-wrapper>
                </div>

            </wc-validation-group>

            <div class="otherText indent" ng-if="basedOnState.check.annanReferens">
                <wc-validation-wrapper field-type="multi-text" validations="viewState.getValidationErrors('annat')">
                    <span>Ange vad:</span> *<br>
                    <textarea id="informationBasedOnOtherText" name="informationBasedOn.otherText" rows='2'
                              class='form-control otherInformation' ng-model="model.annanReferensBeskrivning"
                              ng-change="viewState.limitOtherField('annanReferensBeskrivning')"
                              ng-blur="validate()"></textarea>

                    <div class="counter">
                        Tecken kvar: {{viewState.inputLimits.ovrigt - viewState.getTotalOvrigtLength()}}
                    </div>
                    <div class="info-transfer">
                        <span message key="fk7263.label.transfertoovrigt"></span>
                    </div>
                </wc-validation-wrapper>
            </div>

        </div>
    </div>
</div>
