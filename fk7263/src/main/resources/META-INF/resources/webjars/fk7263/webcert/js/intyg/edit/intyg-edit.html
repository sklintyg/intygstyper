<a id="top"></a>
<div class="container-fluid" id="edit-fk7263">
  <div class="row">
    <div class="col-md-12 webcert-col webcert-col-single">

      <div ui-view="header"></div>

      <!-- Integration deleted message -->
      <div id="integration-deleted" ng-if="viewState.deleted">
        <div class="alert alert-info banner-margin">
          Utkastet är raderat och borttaget från Webcert.
        </div>
      </div>

      <!-- FK 7263 -->
      <div class="edit-form" ng-class="{'collapsed' : widgetState.collapsedHeader}">

        <form name="certForm" novalidate autocomplete="off" wc-auto-save="save(true)">
          <div ng-hide="widgetState.activeErrorMessageKey || widgetState.deleted">

            <div wc-spinner label="info.loadingdata" show-spinner="!widgetState.doneLoading"
                 show-content="widgetState.doneLoading">

              <div class="alert alert-danger" ng-show="widgetState.showComplete && !isComplete"
                   style="margin-right: 20px">
                <h3><span message key="draft.saknar-uppgifter"></span></h3>
                <ul>
                  <li ng-repeat="message in validationMessages">
                    <span message key="{{message.message}}"></span></li>
                </ul>
              </div>

              <div id="certificate" class="row certificate">
                <div class="col-md-12 cert-body">

                  <!-- 1. Smittskydd -->
                  <div ui-view="form1"/>

                  <!-- 4b. Intyger baseras på -->
                  <div ui-view="form4b"/>

                  <!-- 2. Diagnosis -->
                  <div ui-view="form2"/>

                  <!-- 3. Sjukdomsförlopp-->
                  <div ui-view="form3"/>

                  <!-- 4. Funktionsnedsättning-->
                  <div ui-view="form4"/>

                  <!-- 5. Aktivitetsbegränsning -->
                  <div ui-view="form5"/>

                  <!-- 8a. Arbete -->
                  <div ui-view="form8a"/>

                  <!-- 8b. Arbetsförmåga -->
                  <div ui-view="form8b"/>

                  <!-- 9. Arbetsförmåga -->
                  <div ui-view="form9"/>

                  <!-- 10. Prognos -->
                  <div ui-view="form10"/>

                  <!-- 6b. Åtgärder -->
                  <div ui-view="form6b"/>

                  <!-- 6a, 7, 11. Rekommendationer -->
                  <div ui-view="form6a-7-11"/>

                  <!-- 12. Kontakt -->
                  <div ui-view="form12"/>

                  <!-- 13. upplysningar -->
                  <div ui-view="form13"/>

                  <!-- 15. upplysningar -->
                  <div ui-view="form15"/>

                  <div wc-field-signing-doctor></div>

                </div>
                <!-- cert body -->

              </div>
              <!-- certificate -->

              <div ng-if="!isSigned" class="print-hide">

                <h3><span message key="common.sign.intyg"></span></h3>

                <div ng-if="!user.userContext.lakare">
                  <div id="sign-requires-doctor-message-text" class="alert alert-info">
                    <span message key="draft.onlydoctorscansign"></span>
                  </div>

                  <div wc-feature-not-active feature="franJournalsystem">
                    <p>
                      <span message key="draft.notifydoctor"></span>
                    </p>
                    <div class="form-group">
                      <button id="vidarebefordraEjHanterad" class="btn"
                              ng-class="{'btn-info': !certMeta.vidarebefordrad, 'btn-default btn-secondary' : certMeta.vidarebefordrad}"
                              title="Skicka mejl med en länk till utkastet för att informera den läkare som ska signera det."
                              ng-click="openMailDialog()">
                        <img ng-if="!certMeta.vidarebefordrad" src="/img/mail.png"> <img ng-if="certMeta.vidarebefordrad"
                                                                                         src="/img/mail_dark.png">
                      </button>
                    </div>

                    <div class="body-row">
                      <label for="mark-as-vidarebefordrad">
                        <input id="mark-as-vidarebefordrad" type="checkbox"
                               ng-disabled="widgetState.vidarebefordraInProgress" ng-model="certMeta.vidarebefordrad"
                               ng-change="onVidarebefordradChange()" /> Vidarebefordrad
                      </label> <span ng-if="widgetState.vidarebefordraInProgress"> <img
                        src="/img/ajax-loader-kit-16x16.gif"></span>
                    </div>
                  </div>
                </div>

                <button id="signera-utkast-button" class="btn btn-success" ng-disabled="!isComplete || certForm.$dirty || signingWithSITHSInProgress"
                        ng-click="sign()" ng-show="user.userContext.lakare"><img ng-show="signingWithSITHSInProgress" ng-src="/img/ajax-loader-small-green.gif"/> <span message key="common.sign"></span>
                </button>

              </div>

            </div>
          </div>

          <wc-disable-key-down wc-disable-key-down-elements=":text,:checkbox,:radio" wc-disable-key-down-done-loading="widgetState.doneLoading" />

        </form>
      </div>

    </div>
    <!-- span12 webcert-col-single -->
  </div>
  <!-- row -->
</div> <!-- container -->
