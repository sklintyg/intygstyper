<!--

    Copyright (C) 2013 Inera AB (http://www.inera.se)

    This file is part of Inera Certificate Modules (http://code.google.com/p/inera-certificate-modules).

    Inera Certificate Modules is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    Inera Certificate Modules is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

-->

<a id="top"></a>
<div class="container-fluid" id="edit-ts-diabetes">
  <div class="row">
    <div class="col-md-12 webcert-col webcert-col-single">

      <div ui-view="header"></div>

      <!-- TS-DIABETES -->
      <div class="edit-form" ng-class="{'collapsed' : viewState.common.collapsedHeader}" wc-size-target>

        <form id="certForm" name="certForm" novalidate autocomplete="off" wc-auto-save="save(true)">
          <div ng-hide="viewState.common.error.activeErrorMessageKey">
            <div wc-spinner label="info.loadingdata" show-spinner="!viewState.common.doneLoading"
                 show-content="viewState.common.doneLoading">

              <div wc-utkast-error-summary view-state="viewState"></div>

              <div id="certificate" class="row certificate">
                <div class="col-md-12 cert-body">

                  <a id="anchor.patient" name="anchor.patient"></a>
                  <div wc-field field-label="ts-diabetes.label.patient" field-has-errors="viewState.common.validationMessagesGrouped.patient" id="patientForm">
                    <div class="alert alert-danger" ng-if="viewState.common.validationMessagesGrouped.patient" id="validationMessages_patient">
                      <ul>
                        <li ng-repeat="message in viewState.common.validationMessagesGrouped.patient"><span message
                                                                                           key="{{message.message}}"></span>
                        </li>
                      </ul>
                    </div>

                    <div class="form-horizontal">
                      <div class="form-group">
                        <label class="col-xs-3 control-label"><span message key="ts-bas.form.postadress"></span></label>
                        <div class="col-xs-9">
                          <input type="text" class="form-control input-full" id="patientPostadress"
                                 name="cert.grundData.patient.postadress" ng-model="cert.grundData.patient.postadress" maxlength="50" wc-focus-on="firstInput">
                        </div>
                      </div>

                      <div class="form-group">
                        <label class="col-xs-3 control-label"><span message key="ts-bas.form.postnummer"></span></label>
                        <div class="col-xs-9">
                          <input type="text" class="form-control input-5" id="patientPostnummer"
                                 name="cert.grundData.patient.postnummer" ng-model="cert.grundData.patient.postnummer" maxlength="6">
                        </div>
                      </div>

                      <div class="form-group">
                        <label class="col-xs-3 control-label"><span message key="ts-bas.form.postort"></span></label>
                        <div class="col-xs-9">
                          <input type="text" class="form-control" id="patientPostort" name="cert.grundData.patient.postort"
                                 ng-model="cert.grundData.patient.postort" maxlength="25">
                        </div>
                      </div>
                    </div>
                  </div>

                  <a id="anchor.intygavser" name="anchor.intygavser"></a>
                  <div wc-field field-label="ts-diabetes.label.intygavser"
                       field-help-text="ts-diabetes.helptext.intyget-avser" field-has-errors="viewState.common.validationMessagesGrouped.intygavser" id="intygetAvserForm">
                    <div class="alert alert-danger" ng-if="viewState.common.validationMessagesGrouped.intygavser" id="validationMessages_intygavser">
                      <ul>
                        <li ng-repeat="message in viewState.common.validationMessagesGrouped.intygavser"><span message
                                                                                              key="{{message.message}}"></span>
                        </li>
                      </ul>
                    </div>
                    <div class="form-group clearfix">
                      <label class="checkbox checkbox-columns col-xs-2"
                             ng-repeat="typ in cert.intygAvser.korkortstyp track by $index"><input
                          id="typcheck{{$index}}" name="typcheck{{$index}}" type="checkbox" ng-model="typ.selected">
                        <span message key="ts-diabetes.label.korkort.{{typ.type}}"></span></label>
                    </div>
                  </div>

                  <a id="anchor.identitet" name="anchor.identitet"></a>
                  <div wc-field field-label="ts-diabetes.label.identitet" field-has-errors="viewState.common.validationMessagesGrouped.identitet" id="identitetForm">
                    <div class="alert alert-danger" ng-if="viewState.common.validationMessagesGrouped.identitet" id="validationMessages_identitet">
                      <ul>
                        <li ng-repeat="message in viewState.common.validationMessagesGrouped.identitet"><span message
                                                                                             key="{{message.message}}"></span>
                        </li>
                      </ul>
                    </div>
                    <div class="form-group clearfix">
                      <label class="radio checkbox-columns col-md-6" ng-repeat="v in viewState.identitet"><input
                          id="identity{{$index}}" name="identity{{$index}}" type="radio" value="{{v.id}}"
                          ng-model="cert.vardkontakt.idkontroll">
                        {{v.label}}</label>
                    </div>
                    <div class="alert alert-info">
                      <span message key="ts-diabetes.helptext.identitet-styrkt-genom.id-kort"></span><br>
                      <span message key="ts-diabetes.helptext.identitet-styrkt-genom.foretags-tjanstekort"></span><br>
                      <span message key="ts-diabetes.helptext.identitet-styrkt-genom.forsakran-enl18kap4"></span><br>
                      <span message key="ts-diabetes.helptext.identitet-styrkt-genom.pass"></span><br>
                    </div>
                  </div>
                  <div class="alert alert-info">
                    <span message key="ts-diabetes.helptext.lakaren-ska-uppmarksamma"></span>
                  </div>

                  <!-- 1. Allmänt -->
                  <a id="anchor.diabetes" name="anchor.diabetes"></a>
                  <div wc-field field-label="ts-diabetes.label.diabetes" class="print-pagebreak-after" field-has-errors="viewState.common.validationMessagesGrouped.diabetes" id="allmantForm">
                    <div class="alert alert-danger" ng-if="viewState.common.validationMessagesGrouped.diabetes" id="validationMessages_diabetes">
                      <ul>
                        <li ng-repeat="message in viewState.common.validationMessagesGrouped.diabetes"><span message
                                                                                            key="{{message.message}}"></span>
                        </li>
                      </ul>
                    </div>
                    <div class="form-group">
                      <label for="diabetesyear"> Vilket år ställdes diagnosen diabetes?</label>
                      <div class="controls">
                        <input id="diabetesyear" class="form-control input-year" type="text" maxlength="4"
                               ng-model="cert.diabetes.observationsperiod" />
                      </div>
                    </div>
                    <div class="form-group">
                      Patienten har diabetes {{cert.diabetes.diabetesTyp}}
                      <label class="radio"><input name="diabetestyp" type="radio" value="DIABETES_TYP_1"
                                                  ng-model="cert.diabetes.diabetestyp">Typ 1</label>
                      <label class="radio"><input name="diabetestyp" type="radio" value="DIABETES_TYP_2"
                                                  ng-model="cert.diabetes.diabetestyp">Typ 2</label>
                    </div>
                    <div class="form-group">
                      Behandling
                      <label class="checkbox"><input id="diabetestreat1" name="diabetestreat1" type="checkbox"
                                                     ng-model="cert.diabetes.endastKost">
                        <span message key="ts-diabetes.label.diabetes.behandling.endast-kost"></span>
                      </label>
                      <label class="checkbox"><input id="diabetestreat2" name="diabetestreat2" type="checkbox"
                                                     ng-model="cert.diabetes.tabletter">
                        <span message key="ts-diabetes.label.diabetes.behandling.tabletter"></span>
                      </label>
                      <label class="checkbox"><input id="diabetestreat3" name="diabetestreat3" type="checkbox"
                                                     ng-model="cert.diabetes.insulin">
                        <span message key="ts-diabetes.label.diabetes.behandling.insulin"></span>
                      </label>
                      <div class="form-group indent" data-ng-show="cert.diabetes.insulin">
                        <label for="insulinBehandlingsperiod"><span message
                                                                    key="ts-diabetes.label.diabetes.behandling.insulin-period"></span></label>
                        <div class="controls">
                          <input id="insulinBehandlingsperiod" class="form-control input-year"
                                 name="insulinBehandlingsperiod" type="text"
                                 ng-model="cert.diabetes.insulinBehandlingsperiod" maxlength="4" />
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label for="annanBehandlingBeskrivning"><span message
                                                                    key="ts-diabetes.label.diabetes.behandling.annan-beskrivning"></span></label>
                      <div class="controls">
                        <input id="annanBehandlingBeskrivning" class="form-control input-full"
                               name="annanBehandlingBeskrivning" type="text"
                               ng-model="cert.diabetes.annanBehandlingBeskrivning" wc-maxlength
                               ng-trim="false" maxlength="53" />
                      </div>
                    </div>
                  </div>

                  <!-- 2. Hypoglykemier (lågt blodsocker)  -->
                  <a id="anchor.hypoglykemier" name="anchor.hypoglykemier"></a>
                  <div wc-field field-label="ts-diabetes.label.hypoglykemier" field-has-errors="viewState.common.validationMessagesGrouped.hypoglykemier" id="hypoglykemierForm">
                    <div class="alert alert-danger" ng-if="viewState.common.validationMessagesGrouped.hypoglykemier" id="validationMessages_hypoglykemier">
                      <ul>
                        <li ng-repeat="message in viewState.common.validationMessagesGrouped.hypoglykemier"><span message
                                                                                                 key="{{message.message}}"></span>
                        </li>
                      </ul>
                    </div>
                    <table class="table table-form">
                      <tr>
                        <th><span message key="common.yes"></span></th>
                        <th><span message key="common.no"></span></th>
                        <th class="maxwidth"></th>
                      </tr>
                      <tr>
                        <td><input id="hypoay" name="hypoa" type="radio" ng-value="true"
                                   ng-model="cert.hypoglykemier.kunskapOmAtgarder"></td>
                        <td><input id="hypoan" name="hypoa" type="radio" ng-value="false"
                                   ng-model="cert.hypoglykemier.kunskapOmAtgarder"></td>
                        <td><span message key="ts-diabetes.label.hypoglykemier.har-patient-kannedom"></span></td>
                      </tr>
                      <tr>
                        <td><input id="hypoby" name="hypob" type="radio" ng-value="true"
                                   ng-model="cert.hypoglykemier.teckenNedsattHjarnfunktion"></td>
                        <td><input id="hypobn" name="hypob" type="radio" ng-value="false"
                                   ng-model="cert.hypoglykemier.teckenNedsattHjarnfunktion"></td>
                        <td><span message key="ts-diabetes.label.hypoglykemier.tecken-nedsatt-hjarnfunktion"></span>
                        </td>
                      </tr>
                      <tr data-ng-show="cert.hypoglykemier.teckenNedsattHjarnfunktion">
                        <td><input id="hypocy" name="hypoc" type="radio" ng-value="true"
                                   ng-model="cert.hypoglykemier.saknarFormagaKannaVarningstecken"></td>
                        <td><input id="hypocn" name="hypoc" type="radio" ng-value="false"
                                   ng-model="cert.hypoglykemier.saknarFormagaKannaVarningstecken"></td>
                        <td><span message
                                  key="ts-diabetes.label.hypoglykemier.saknar-formaga-kanna-varningstecken"></span></td>
                      </tr>
                      <tr data-ng-show="cert.hypoglykemier.teckenNedsattHjarnfunktion">
                        <td><input id="hypody" name="hypod" type="radio" ng-value="true"
                                   ng-model="cert.hypoglykemier.allvarligForekomst"></td>
                        <td><input id="hypodn" name="hypod" type="radio" ng-value="false"
                                   ng-model="cert.hypoglykemier.allvarligForekomst"></td>
                        <td><span message key="ts-diabetes.label.hypoglykemier.allvarlig-forekomst"></span>

                          <div class="controls" ng-show="cert.hypoglykemier.allvarligForekomst == true">
                            <label for="allvarligForekomstBeskrivning">
                              <span message
                                    key="ts-diabetes.label.hypoglykemier.allvarlig-forekomst.beskrivning"></span>
                            </label>
                            <input id="allvarligForekomstBeskrivning" class="form-control input-full"
                                   name="allvarligForekomstBeskrivning" type="text"
                                   ng-model="cert.hypoglykemier.allvarligForekomstBeskrivning" wc-maxlength
                                   ng-trim="false" maxlength="40" />
                          </div>
                        </td>
                      </tr>
                      <tr data-ng-show="cert.hypoglykemier.teckenNedsattHjarnfunktion">
                        <td><input id="hypoey" name="hypoe" type="radio" ng-value="true"
                                   ng-model="cert.hypoglykemier.allvarligForekomstTrafiken"></td>
                        <td><input id="hypoen" name="hypoe" type="radio" ng-value="false"
                                   ng-model="cert.hypoglykemier.allvarligForekomstTrafiken"></td>
                        <td><span message key="ts-diabetes.label.hypoglykemier.allvarlig-forekomst-trafiken"></span>
                          <div class="controls" ng-show="cert.hypoglykemier.allvarligForekomstTrafiken == true">
                            <label for="allvarligForekomstTrafikBeskrivning">
                              <span message
                                    key="ts-diabetes.label.hypoglykemier.allvarlig-forekomst-trafiken.beskrivning"></span>
                            </label>
                            <input id="allvarligForekomstTrafikBeskrivning" class="form-control input-full"
                                   name="allvarligForekomstTrafikBeskrivning" type="text"
                                   ng-model="cert.hypoglykemier.allvarligForekomstTrafikBeskrivning" wc-maxlength
                                   ng-trim="false" maxlength="35" />
                          </div>
                        </td>
                      </tr>
                      <tr data-ng-show="viewState.korkortd">
                        <td></td>
                        <td></td>
                        <td><h5 class="inline-heading">För innehav av behörigheterna C1, C1E, C, CE, D1, D1E, D, DE och
                          taxiförarlegitimation ska även fråga f-g besvaras</h5></td>
                      </tr>
                      <!-- 2f -->
                      <tr data-ng-show="viewState.korkortd">
                        <td><input id="hypofy" name="hypof" type="radio" ng-value="true"
                                   ng-model="cert.hypoglykemier.egenkontrollBlodsocker"></td>
                        <td><input id="hypofn" name="hypof" type="radio" ng-value="false"
                                   ng-model="cert.hypoglykemier.egenkontrollBlodsocker"></td>
                        <td><span message key="ts-diabetes.label.hypoglykemier.egenkontroll-blodsocker"></span></td>
                      </tr>

                      <!-- 2g -->
                      <tr data-ng-show="viewState.korkortd">
                        <td><input id="hypogy" name="hypog" type="radio" ng-value="true"
                                   ng-model="cert.hypoglykemier.allvarligForekomstVakenTid"></td>
                        <td><input id="hypogn" name="hypog" type="radio" ng-value="false"
                                   ng-model="cert.hypoglykemier.allvarligForekomstVakenTid"></td>
                        <td><span message key="ts-diabetes.label.hypoglykemier.allvarlig-forekomst-vaken-tid"></span>
                          <div class="controls form-inline webcert-top-padding-section" data-ng-show="cert.hypoglykemier.allvarligForekomstVakenTid">
                            <label class="control-label"><span message key="common.when"></span></label>
                            <span wc-date-picker-field target-model="cert.hypoglykemier.allvarligForekomstVakenTidObservationstid"
                                  dom-id="allvarligForekomstVakenTidObservationstid"
                                  invalid="false"
                                max-date="{{tomorrowDate}}"></span>
                            <p>(Fyll i åååå-mm-dd)</p>
                          </div>
                        </td>
                      </tr>
                    </table>
                  </div>

                  <!-- 3. Synintyg -->
                  <a id="anchor.syn" name="anchor.syn"></a>
                  <div wc-field field-label="ts-diabetes.label.synintyg" field-has-errors="viewState.common.validationMessagesGrouped.syn" ng-form
                       name="synForm" id="synForm">
                    <table class="table table-form">
                      <tr ng-if="viewState.common.validationMessagesGrouped.syn" id="validationMessages_syn">
                        <td colspan="3">
                          <div class="alert alert-danger">
                            <ul>
                              <li ng-repeat="message in viewState.common.validationMessagesGrouped.syn"><span message
                                                                                             key="{{message.message}}"></span>
                              </li>
                            </ul>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td></td>
                        <td><h5>Alternativ 1</h5></td>
                      </tr>
                      <tr>
                        <td></td>
                        <td></td>
                        <td>Vid synnedsättningar av betydelse för innehavet krävs ögonläkarintyg. Detta gäller vid
                          proliferativ retinopati, genomgången laserbehandling av retinopati, signifikant makulaödem
                          eller
                          vid annan ögonsjukdom samt om ögonbottenfoto saknas.
                        </td>
                      </tr>
                      <tr>
                        <th><span message key="common.yes"></span></th>
                        <th><span message key="common.no"></span></th>
                        <th class="maxwidth"></th>
                      </tr>
                      <tr>
                        <td><input id="synay" name="syna" type="radio" ng-value="true"
                                   ng-model="cert.syn.separatOgonlakarintyg"></td>
                        <td><input id="synan" name="syna" type="radio" ng-value="false"
                                   ng-model="cert.syn.separatOgonlakarintyg"></td>
                        <td><span message key="ts-diabetes.label.syn.separat-ogonlakarintyg"></span></td>
                      </tr>
                      <tr data-ng-hide="cert.syn.separatOgonlakarintyg">
                        <td></td>
                        <td></td>
                        <td><h5 class="inline-heading">Alternativ 2: (frågorna b-d besvaras)</h5></td>
                      </tr>
                      <tr data-ng-hide="cert.syn.separatOgonlakarintyg">
                        <td></td>
                        <td></td>
                        <td>Om ögonläkarintyg inte krävs kan behandlande specialistkompetent läkare med god kännedom om
                          patientens sjukdom här avge intyg om synfunktionen.
                        </td>
                      </tr>
                      <tr data-ng-hide="cert.syn.separatOgonlakarintyg">
                        <td><input id="synby" name="synb" type="radio" ng-value="true"
                                   ng-model="cert.syn.synfaltsprovningUtanAnmarkning"></td>
                        <td><input id="synbn" name="synb" type="radio" ng-value="false"
                                   ng-model="cert.syn.synfaltsprovningUtanAnmarkning"></td>
                        <td>
                          <span message key="ts-diabetes.label.syn.synfaltsprovning-utan-anmarkning"></span>
                        </td>
                      </tr>
                      <tr data-ng-hide="cert.syn.separatOgonlakarintyg">
                        <td></td>
                        <td></td>
                        <td>
                          <p><span message key="ts-diabetes.label.syn.synskarpa"></span></p>

                          <div class="alert alert-info">
                            <span message key="ts-diabetes.helptext.synfunktioner.synskarpa"></span>
                          </div>

                          <table class="table table-form">
                            <tr>
                              <th></th>
                              <th>Utan korrektion <span wc-enable-tooltip
                                                        field-help-text="ts-diabetes.helptext.synfunktioner.utan-korrektion"></span>
                              </th>
                              <th>Med korrektion <span wc-enable-tooltip
                                                       field-help-text="ts-diabetes.helptext.synfunktioner.med-korrektion"></span>
                              </th>
                            </tr>
                            <tr>
                              <td>Höger öga</td>
                              <td><input type="text" class="form-control small-decimal" wc-decimal-number wc-decimal-max-numbers="2"
                                         id="synHogerOgaUtanKorrektion" ng-model="cert.syn.hoger.utanKorrektion" maxlength="4"></td>
                              <td><input type="text" class="form-control small-decimal" wc-decimal-number wc-decimal-max-numbers="2"
                                         id="synHogerOgaMedKorrektion" ng-model="cert.syn.hoger.medKorrektion" maxlength="4"></td>
                            </tr>
                            <tr>
                              <td>Vänster öga</td>
                              <td><input type="text" class="form-control small-decimal" wc-decimal-number wc-decimal-max-numbers="2"
                                         id="synVansterOgaUtanKorrektion" ng-model="cert.syn.vanster.utanKorrektion" maxlength="4"></td>
                              <td><input type="text" class="form-control small-decimal" wc-decimal-number wc-decimal-max-numbers="2"
                                         id="synVansterOgaMedKorrektion" ng-model="cert.syn.vanster.medKorrektion" maxlength="4"></td>
                            </tr>
                            <tr>
                              <td>Binokulärt</td>
                              <td><input type="text" class="form-control small-decimal" wc-decimal-number wc-decimal-max-numbers="2"
                                         id="synBinokulartUtanKorrektion" ng-model="cert.syn.binokulart.utanKorrektion" maxlength="4"></td>
                              <td><input type="text" class="form-control small-decimal" wc-decimal-number wc-decimal-max-numbers="2"
                                         id="synBinokulartMedKorrektion" ng-model="cert.syn.binokulart.medKorrektion" maxlength="4"></td>
                            </tr>
                          </table>
                      </tr>
                      <tr data-ng-hide="cert.syn.separatOgonlakarintyg">
                        <td><input id="syndy" name="synd" type="radio" ng-value="true" ng-model="cert.syn.diplopi">
                        </td>
                        <td><input id="syndn" name="synd" type="radio" ng-value="false" ng-model="cert.syn.diplopi">
                        </td>
                        <td>d) Förekommer dubbelseende?</td>
                      </tr>
                    </table>
                  </div>

                  <!-- 4. Bedömning -->
                  <a id="anchor.bedomning" name="anchor.bedomning"></a>
                  <div wc-field field-label="ts-diabetes.label.bedomning" field-help-text="ts-diabetes.helptext.intyget-avser" field-has-errors="viewState.common.validationMessagesGrouped.bedomning" id="bedomningForm">
                    <div class="alert alert-danger" ng-if="viewState.common.validationMessagesGrouped.bedomning" id="validationMessages_bedomning">
                      <ul>
                        <li ng-repeat="message in viewState.common.validationMessagesGrouped.bedomning"><span message
                                                                                             key="{{message.message}}"></span>
                        </li>
                      </ul>
                    </div>

                    <table class="table table-form">
                      <tr>
                        <td></td>
                        <td></td>
                        <td>
                          <p>Patienten uppfyller kraven enligt 6 kap. i Transportstyrelsens föreskrifter och allmänna
                            råd om
                            medicinska krav för innehav av körkort m.m. (TSFS 2010:125, senast ändrade genom TSFS
                            2013:2).
                            Föreskrivna krav på läkarens specialistkompetens vid diabetessjukdom anges i 17 kap.
                            Se <a href="http://www.transportstyrelsen.se" target="_blank">www.transportstyrelsen.se</a>.</p>

                          <div class="form-group">
                            <label class="radio"><input id="behorighet_bedomning" name="behorighet" type="radio" ng-value="false"
                                                        ng-model="cert.bedomning.kanInteTaStallning"> Någon av följande
                              behörigheter</label>
                            <div class="form-group clearfix indent" data-ng-show="!cert.bedomning.kanInteTaStallning">
                              <label class="checkbox checkbox-columns col-xs-2"
                                     ng-repeat="typ in cert.bedomning.korkortstyp track by $index"><input
                                  id="korkortstyp{{$index}}" name="korkortstyp{{$index}}" type="checkbox"
                                  ng-model="typ.selected"> <span message
                                                                 key="ts-diabetes.label.korkort.{{typ.type}}"></span></label>
                            </div>
                            <label class="radio"><input id="behorighet_kanintetastallning" name="behorighet" type="radio" ng-value="true"
                                                        ng-model="cert.bedomning.kanInteTaStallning"> Kan inte ta ställning</label>
                          </div>
                        </td>
                      </tr>
                      <tr data-ng-show="viewState.korkortd">
                        <th><span message key="common.yes"></span></th>
                        <th><span message key="common.no"></span></th>
                        <th class="maxwidth"></th>
                      </tr>
                      <tr data-ng-show="viewState.korkortd">
                        <td><input id="bedomningy" name="bedomning" type="radio" ng-value="true"
                                   ng-model="cert.bedomning.lamplighetInnehaBehorighet"></td>
                        <td><input id="bedomningn" name="bedomning" type="radio" ng-value="false"
                                   ng-model="cert.bedomning.lamplighetInnehaBehorighet"></td>
                        <td><span message key="ts-diabetes.label.bedomning.lamplighet-inneha"></span></td>
                      </tr>
                    </table>
                  </div>

                  <!-- Övriga upplysningar -->
                  <div wc-field field-label="ts-diabetes.label.empty">
                    <h5>Övriga upplysningar och kommentarer</h5>
                    <textarea class="form-control" ng-model="cert.kommentar" wc-maxlength ng-trim="false"
                              id="kommentar" maxlength="189" rows="4"></textarea>
                  </div>

                  <!-- Specialistkompetens -->
                  <div wc-field field-label="ts-diabetes.label.empty">
                    <h5>Patienten bör före ärendets avgörande undersökas av läkare med specialistkompetens i</h5>
                    <textarea class="form-control" name="specialist" rows='2' id="specialist"
                              ng-model="cert.bedomning.lakareSpecialKompetens" wc-maxlength ng-trim="false"
                              maxlength="71"></textarea>
                  </div>

                  <!-- Vardenhet -->
                  <a id="anchor.vardenhet" name="anchor.vardenhet"></a>
                  <div id="vardenhetForm" wc-field field-label="ts-diabetes.label.vardenhet" field-has-errors="viewState.common.validationMessagesGrouped.vardenhet">
                    <div class="alert alert-danger" ng-if="viewState.common.validationMessagesGrouped.vardenhet" id="validationMessages_vardenhet">
                      <ul>
                        <li ng-repeat="message in viewState.common.validationMessagesGrouped.vardenhet"><span message
                                                                                             key="{{message.message}}"></span>
                        </li>
                      </ul>
                    </div>
                    <label class="control-label">{{cert.grundData.skapadAv.vardenhet.enhetsnamn}}
                      ({{cert.grundData.skapadAv.vardenhet.enhetsid}}),
                      {{cert.grundData.skapadAv.vardenhet.vardgivare.vardgivarnamn}}</label>

                    <div id="hsaInfo" class="alert alert-info" ng-show="viewState.common.hsaInfoMissing">
                      Information om vårdenheten saknas i HSA-katalogen. Be den på vårdenheten som är ansvarig för
                      frågor om HSA att uppdatera informationen.
                    </div>

                    <div class="form-horizontal">
                      <div class="form-group">
                        <label class="col-xs-3 control-label">Postadress</label>
                        <div class="col-xs-9">
                          <input type="text" class="form-control input-full" id="clinicInfoPostalAddress"
                                 name="clinicInfo.postalAddress" ng-model="cert.grundData.skapadAv.vardenhet.postadress"
                                 maxlength="70">
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-xs-3 control-label">Postnummer</label>
                        <div class="col-xs-9">
                          <input type="text" class="form-control input-5" id="clinicInfoPostalCode"
                                 name="clinicInfo.postalCode" ng-model="cert.grundData.skapadAv.vardenhet.postnummer"
                                 maxlength="6">
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-xs-3 control-label">Postort</label>
                        <div class="col-xs-9">
                          <input type="text" class="form-control" id="clinicInfoPostalCity"
                                 name="clinicInfo.postalCity" ng-model="cert.grundData.skapadAv.vardenhet.postort"
                                 maxlength="30">
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-xs-3 control-label">Telefonnummer</label>
                        <div class="col-xs-9">
                          <input type="text" class="form-control" id="clinicInfoPhone" name="clinicInfo.phone"
                                 ng-model="cert.grundData.skapadAv.vardenhet.telefonnummer" maxlength="20">
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="body-row clearfix">
                    <div ng-if="specialiteter && specialiteter != ''">
                      <h4><span message key="ts-bas.label.specialkompetens"></span></h4>
                      <span> {{specialiteter}}</span><br />
                    </div>
                    <br />
                    <div ng-if="befattningar && befattningar.length > 0">
                      <h4><span message key="ts-bas.label.befattningar"></span></h4>
                      <span ng-repeat="befattning in befattningar"></span>
                    </div>
                    <br />
                  </div>

                  <div ng-if="!isSigned" class="print-hide">
                    <h3><span message key="common.sign.intyg"></span></h3>

                    <div ng-if="!user.userContext.lakare">
                      <div id="sign-requires-doctor-message-text" class="alert alert-info">
                        <span message key="draft.onlydoctorscansign"></span>
                      </div>

                      <h4>Notifiera läkare</h4>
                      <div class="form-group">
                        <button id="vidarebefordraEjHanterad"
                                class="btn"
                                ng-class="{'btn-info': !viewState.draftModel.vidarebefordrad, 'btn-default btn-secondary' : viewState.draftModel.vidarebefordrad}"
                                title="Skicka mejl med en länk till utkastet för att informera den läkare som ska signera det."
                                ng-click="openMailDialog()">
                          <img ng-if="!viewState.draftModel.vidarebefordrad" src="/img/mail.png"> <img ng-if="viewState.draftModel.vidarebefordrad" src="/img/mail_dark.png">
                        </button>
                      </div>

                      <label for="mark-as-vidarebefordrad" class="checkbox-inline">
                        <input id="mark-as-vidarebefordrad" type="checkbox"
                               ng-disabled="viewState.common.vidarebefordraInProgress"
                               ng-model="viewState.draftModel.vidarebefordrad"
                               ng-change="onVidarebefordradChange()" /> Vidarebefordrad
                      </label> <span ng-if="viewState.common.vidarebefordraInProgress"> <img src="/img/ajax-loader-kit-16x16.gif"></span>
                    </div>

                    <button id="signera-utkast-button" class="btn btn-success"
                            ng-disabled="!viewState.common.intyg.isComplete || certForm.$dirty" ng-click="sign()"
                            ng-show="user.userContext.lakare"><span message key="common.sign"></span>
                    </button>
                  </div>

                </div>
                <!-- cert body -->

              </div>
              <!-- certificate -->

            </div>
          </div>
        </form>
      </div>

    </div>
    <!-- span12 webcert-col-single -->
  </div>
  <!-- row -->
</div> <!-- container -->
